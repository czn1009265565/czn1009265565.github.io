# 分布式ID

分布式ID是在分布式系统中生成唯一标识符的机制，用于解决多个节点并发生成ID时可能出现的冲突问题。

例如传统的单体架构单库单表，数据库自增ID在分布式服务架构模式下分库分表的设计，
使得多个库或多个表存储相同的业务数据。
这种情况根据数据库的自增ID就会产生相同ID的情况，不能保证主键的唯一性。

## UUID

- 原理: 基于时间、随机数或MAC地址生成128位唯一标识符。
- 优点:
  - 生成简单，无需中心化节点。
  - 全球唯一，冲突概率极低。
- 缺点: 
  - 长度较长（36字符），存储和索引效率低。
  - 无序性可能导致数据库写入性能下降。

## 雪花算法

- 原理: 时间戳+机器序号+自增数 `0 | 时间戳（41位） | 数据中心ID（5位） | 机器ID（5位） | 序列号（12位）`

- 优点: 
  - 高性能，本地生成无需网络调用。
  - ID趋势递增，利于数据库索引。
- 缺点: 
  - 依赖系统时钟，时钟回拨可能导致ID重复。


## Leaf算法

- 原理: 美团开源的分布式ID生成系统，结合数据库号和Snowflake方案。
  - Leaf-segment: 通过数据库批量获取号段，降低数据库压力。
  - Leaf-snowflake: 优化时钟回拨问题，引入ZooKeeper协调节点。
- 优点: 
  - 高可用、可扩展，兼顾性能和可靠性。