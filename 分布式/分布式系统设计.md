# 分布式系统介绍

分布式系统是一个硬件或软件组件分布在不同的网络计算机上，彼此之间仅仅通过消息传递进行通信和协调的系统。
简单来说就是一群独立计算机集合共同对外提供服务，但是对于系统的用户来说，就像是一台计算机在提供服务一样

## 分布式理论

### CAP理论
在理论计算机科学中，CAP 定理（CAP theorem）指出对于一个分布式系统来说，当设计读写操作时，只能同时满足以下三点中的两个：

- **一致性（Consistency）** : 所有节点访问同一份最新的数据副本
- **可用性（Availability）**: 非故障的节点在合理的时间内返回合理的响应（不是错误或者超时的响应）。
- **分区容错性（Partition Tolerance）** : 分布式系统出现网络分区的时候，仍然能够对外提供服务。


**网络分区:**  
分布式系统中，部分节点由于网络原因彼此失联，即与其他节点形成网络分区。


当发生网络分区的时候，如果我们要继续服务，那么强一致性和可用性只能 2 选 1。
也就是说当网络分区之后 P 是前提，决定了 P 之后才有 C 和 A 的选择。也就是说分区容错性（Partition tolerance）我们是必须要实现的


### Base理论

BASE 理论本质上是对 CAP 的延伸和补充，更具体地说，是对 CAP 中 AP 方案的一个补充。

1. Basically Available(基本可用)  
   假设系统，出现了不可预知的故障，但还是能用，相比较正常的系统而言
2. Soft State(软状态)  
   允许系统中的数据存在中间状态，并认为该状态不影响系统的整体可用性，即允许系统在多个不同节点的数据副本存在数据延时
3. Eventually Consistent(最终一致性)  
   上面说软状态，然后不可能一直是软状态，必须有个时间期限。在期限过后，应当保证所有副本保持数据一致性，从而达到数据的最终一致性。

**核心思想:**  
即使无法做到强一致性（Strong consistency），但每个应用都可以根据自身的业务特点，采用适当的方式来使系统达到最终一致性



## 需要解决的问题
1. 分布式ID: 雪花算法
2. 分布式缓存: Redis哨兵模式
3. 分布式任务调度: 基于消息队列,Quartz,XXL-Job
4. 分布式限流: Sentinel
5. 分库分表: ShardingJDBC
6. 分布式事务: 2PC,TCC,事务消息
7. 分布式锁: Redisson
8. 统一日志检索: ELK
9. 调用链: TraceId
10. 分布式中间件: Kafka,Elasticsearch

### 分布式Id
**分布式ID的特点**  
- 全局唯一
- 高并发
- 高可用

**雪花算法(snowflake)**  
时间戳+机器序号+自增数