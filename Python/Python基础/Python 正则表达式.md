# Python 正则表达式

## 一、基础语法

### 1. 元字符

| 元字符     | 描述          | 示例                         |
|---------|-------------|----------------------------|
| `.`     | 匹配任意字符（除换行） | `a.c` → `"abc"`, `"a c"`   |
| `^`     | 匹配字符串开头     | `^a` → `"a"`开头             |
| `$`     | 匹配字符串结尾     | `a$` → `"a"`结尾             |
| `*`     | 前字符0次或多次    | `ab*` → `"a"`, `"abbb"`    |
| `+`     | 前字符1次或多次    | `ab+` → `"ab"`, `"abbb"`   |
| `?`     | 前字符0次或1次    | `ab?` → `"a"`, `"ab"`      |
| `{m,n}` | 前字符m到n次     | `a{2,4}` → `"aa"`, `"aaa"` |

### 2. 字符类

| 模式       | 描述                   | 示例                 |
|----------|----------------------|--------------------|
| `[abc]`  | 匹配a、b或c              | `[aeiou]` → 匹配任意元音 |
| `[^abc]` | 匹配**非**a、b、c的字符      | `[^0-9]` → 非数字     |
| `[a-z]`  | 匹配小写字母               | `[a-z]+` → 连续小写字母  |
| `\d`     | 数字（等价于`[0-9]`）       | `\d{3}` → 3位数字     |
| `\D`     | 非数字                  | `\D+` → 连续非数字      |
| `\w`     | 单词字符（`[a-zA-Z0-9_]`） | `\w+` → 单词         |
| `\W`     | 非单词字符                | `\W` → 标点/空格       |
| `\s`     | 空白字符（空格、`\t`等）       | `\s+` → 连续空白       |
| `\S`     | 非空白字符                | `\S+` → 连续非空白      |

### 3. 分组与捕获

| 模式                  | 描述    | 示例                       |
|---------------------|-------|--------------------------|
| `(pattern)`         | 捕获分组  | `(ab)+` → `"abab"`       |
| `(?:pattern)`       | 非捕获分组 | `(?:ab)+` → 不保留分组        |
| `(?P<name>pattern)` | 命名分组  | `(?P<year>\d{4})` → 命名捕获 |

## 二、re模块核心方法

### 1. 匹配与搜索

| 方法               | 描述           | 示例                                      |
|------------------|--------------|-----------------------------------------|
| `re.match()`     | 从**字符串开头**匹配 | `re.match(r'\d+', '123abc')` → `'123'`  |
| `re.search()`    | 搜索**整个字符串**  | `re.search(r'\d+', 'abc123')` → `'123'` |
| `re.fullmatch()` | 匹配**整个字符串**  | `re.fullmatch(r'\d+', '123')` → 匹配      |

### 2. 查找所有匹配

| 方法              | 描述               | 示例                                                        |
|-----------------|------------------|-----------------------------------------------------------|
| `re.findall()`  | 返回所有匹配的**字符串列表** | `re.findall(r'\d+', 'a1b22c')` → `['1', '22']`            |
| `re.finditer()` | 返回**迭代器**（含匹配对象） | `for m in re.finditer(r'\d+', 'a1b22'): print(m.group())` |

### 3. 分割与替换

| 方法           | 描述       | 示例                                               |
|--------------|----------|--------------------------------------------------|
| `re.split()` | 按模式分割字符串 | `re.split(r'\d+', 'a1b22c')` → `['a', 'b', 'c']` |
| `re.sub()`   | 替换匹配的文本  | `re.sub(r'\d+', '#', 'a1b22')` → `'a#b#'`        |

## 三、匹配对象（Match）方法

| 方法          | 描述        | 示例                             |
|-------------|-----------|--------------------------------|
| `.group()`  | 返回整个匹配    | `m.group()` → `'123'`          |
| `.group(n)` | 返回第n个分组   | `m.group(2)` → `'ab'`          |
| `.groups()` | 返回所有分组的元组 | `m.groups()` → `('123', 'ab')` |
| `.span()`   | 返回匹配的起止位置 | `m.span()` → `(1, 4)`          |

## 四、高级技巧

### 1. 贪婪 vs 非贪婪

```python
import re

re.search(r'<.*>', '<a> <b>').group()   # 贪婪: '<a> <b>'
re.search(r'<.*?>', '<a> <b>').group()  # 非贪婪: '<a>'
```

### 2. 预编译正则表达式

```python
import re

pattern = re.compile(r'\d+')
pattern.findall('a1b22')
# ['1', '22']
```

### 3. 常用标志

| 标志            | 描述       | 简写    |
|---------------|----------|-------|
| re.IGNORECASE | 	忽略大小写   | 	re.I |
| re.MULTILINE	 | 多行模式     | 	re.M |
| re.DOTALL     | 	让.匹配换行符 | 	re.S |


## 五、实用示例

1. 提取邮箱  
```python
re.findall(r'\b[\w.-]+@[\w.-]+\.\w+\b', 'user@example.com')
```
2. 密码验证  
```python
# 验证是否满足8位密码，且包含大小写字母及数字，匹配成功返回 Match 对象，失败则返回None
re.fullmatch(r'^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{8,}$', password)
```
3. 日期格式转换  
```python
re.sub(r'(\d{4})-(\d{2})-(\d{2})', r'\3/\2/\1', '2023-05-21')  # → '21/05/2023'
```
