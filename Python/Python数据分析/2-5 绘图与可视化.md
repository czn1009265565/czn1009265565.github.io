# 绘图与可视化

信息可视化（也叫绘图）是数据分析中最重要的工作之一，
Python有许多库进行静态或动态的数据可视化，`Matplotlib` 是最核心、最著名的二维绘图库。

## 基础绘图流程

```python
import matplotlib.pyplot as plt

x = [1, 2, 3, 4, 5]
y = [2, 4, 1, 5, 3]
plt.plot(x, y)          # 绘制折线图
plt.title("简单折线图")  # 标题
plt.xlabel("X轴")       # X轴标签
plt.ylabel("Y轴")       # Y轴标签
plt.show()              # 显示图形
```

中文乱码需要添加如下配置
```python
plt.rcParams['font.sans-serif'] = ['SimHei']  # 黑体
plt.rcParams['axes.unicode_minus'] = False    # 解决负号显示问题
```

## Figure和Subplot

类比一下生活中用纸笔绘图，我们需要先找到一张白纸， 在白纸上绘图。
使用Matplotlib面向对象绘图，绘图前我们要先创建一个Figure对象，Figure对象就相当于是白纸，
AxesSubplot就相当于白纸上的绘图区，拥有自己独立的坐标系统。

### 创建画布和子图

逐个追加
```python
fig = plt.figure()
axes1 = fig.add_subplot(2,2,1)
axes2 = fig.add_subplot(2,2,2)
axes3 = fig.add_subplot(2,2,3)
```

创建单个画布与子图
```python
x = [1, 2, 3, 4, 5]
y = [2, 4, 1, 5, 3]

fig, ax = plt.subplots()
ax.plot(x, y)
ax.set_title('single subplot')
plt.show()
```

创建多个子图
```python
x = np.arange(0, 10)
y = np.sin(x)
data = np.random.randn(1000)

fig, axes = plt.subplots(2, 2, figsize=(10, 6))
axes[0,0].plot(x, y)
axes[0,1].scatter(x, y)
axes[1,0].bar(x, y)
axes[1,1].hist(data, bins=30, edgecolor='black')
plt.show()
```

## 图形样式和定制

### 颜色、线性与标记

```python
x = np.array([1, 2, 3, 4, 5])
y = np.array([2, 4, 6, 8, 10])

# 颜色示例
colors = ['red', 'blue', 'green', 'orange', 'purple']

# 线型示例
linestyles = ['-', '--', '-.', ':']

# 标记示例
markers = ['o', 's', '^', 'D', 'v']

fig, ax = plt.subplots(figsize=(10, 6))

for i in range(5):
    y = np.sin(x + i * 0.5)
    ax.plot(x, y,
             color=colors[i],
             linestyle=linestyles[i % 4],
             marker=markers[i],
             markersize=6,
             markevery=10,
             label=f'曲线 {i+1}')
plt.show()
```

### 刻度、标签与图例

```python
x = np.arange(10)
fig, axes = plt.subplots(figsize=(10, 6))
axes.plot(x, np.sin(x), label="图例标签")

# 设置坐标轴范围
axes.set_xlim(0, 12)
axes.set_ylim(-1.5, 1.5)

# 设置刻度
axes.set_xticks([0, 2, 4, 6, 8, 10, 12])
axes.set_yticks([-1, -0.5, 0, 0.5, 1])

# 添加网格
axes.grid(True, linestyle='--', alpha=0.7)

# 设置坐标轴标签
axes.set_xlabel('时间 (秒)', fontsize=12)
axes.set_ylabel('振幅', fontsize=12)
axes.set_title('定制坐标轴示例', fontsize=14)
# 添加图例
axes.legend()
plt.show()
```

## 注解

### 文本注解

```python
# 创建基础图表
fig, ax = plt.subplots(figsize=(10, 6))
x = np.linspace(0, 10, 100)
y = np.sin(x)

ax.plot(x, y)
ax.grid(True, alpha=0.3)

# 添加文本注解
ax.text(2, 0.5, '文本注解', fontsize=12,
        bbox=dict(boxstyle='round', facecolor='wheat', alpha=0.8))

# 在数据点添加注解
max_point = (np.pi/2, 1)
ax.text(max_point[0], max_point[1] + 0.1, '最大值点',
        ha='center', va='bottom', fontsize=10,
        bbox=dict(boxstyle='round,pad=0.3', facecolor='yellow', alpha=0.7))

plt.show()
```

### 箭头注解

```python
x = np.linspace(0, 10, 100)
y = np.sin(x)

fig, ax = plt.subplots(figsize=(10, 6))
ax.plot(x, y)
ax.grid(True, alpha=0.3)

# 添加带箭头的注解
ax.annotate('最大值', xy=(np.pi/2, 1), xytext=(4, 0.5),
            arrowprops=dict(arrowstyle='->', connectionstyle='arc3', color='red'),
            fontsize=12, bbox=dict(boxstyle='round', facecolor='lightblue', alpha=0.8))

# 另一个箭头注解示例
ax.annotate('零点', xy=(np.pi, 0), xytext=(8, -0.5),
            arrowprops=dict(arrowstyle='fancy', color='green', lw=2),
            fontsize=12)

plt.show()
```

### 图形

```python
# 创建画布
fig, ax = plt.subplots(figsize=(10, 8))
ax.set_xlim(0, 10)
ax.set_ylim(0, 10)
ax.set_aspect('equal')  # 保持纵横比相等
ax.grid(True, alpha=0.3)

# 方法1：使用 patches.Rectangle
rect = patches.Rectangle(
        (1, 1),           # 左下角坐标 (x, y)
        3, 2,             # 宽度和高度
        linewidth=2,      # 边框线宽
        edgecolor='blue', # 边框颜色
        facecolor='lightblue',  # 填充颜色
        alpha=0.7,        # 透明度
        label='矩形1'
)
ax.add_patch(rect)

circle = patches.Circle(
        (3, 7),           # 圆心坐标 (x, y)
        1.5,              # 半径
        linewidth=2,
        edgecolor='purple',
        facecolor='violet',
        alpha=0.7,
        label='圆形1'
)
ax.add_patch(circle)

# 顶点坐标
triangle_verts = np.array([[2, 4], [4, 4], [3, 6]])
triangle = patches.Polygon(
        triangle_verts,
        closed=True,      # 是否闭合
        linewidth=2,
        edgecolor='darkgreen',
        facecolor='lightgreen',
        alpha=0.7,
        label='三角形'
)
ax.add_patch(triangle)
plt.show()
```

## 保存至文件